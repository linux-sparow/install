#!/bin/bash

dirsrc="$1/distrib/packer"
source "$1/config/packer"


## validate packar
if [[ -z $( echo $DISTRO_INSTALLATION_PACKAGE ) ]];then
    echo "error : Package list is empty" &&
    exit
fi


## prepare packar
if [[ -d $appdir ]]; then
    rm -fr "$appdir/*"
else
    mkdir -p "$appdir"
fi


## download packar
sudo pacman --sync --downloadonly --noconfirm --cachedir "$dirsrc/" $DISTRO_INSTALLATION_PACKAGE &&
sudo repo-add "$dirsrc/$DISTRO_UNIQ.db.tar.zst" "$dirsrc/*.pkg.tar.zst"